<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>창세기 성경 퀴즈</title>
  <style>
    :root{
      --bg:#0b1020;--card:#121a34;--ink:#e8eeff;--muted:#9fb0ff;--accent:#7aa2ff;--good:#3ad39f;--bad:#ff6b6b;--warn:#ffb84d;
      --br:18px;--gap:14px;--shadow:0 10px 30px rgba(0,0,0,.25);
    }
    *{box-sizing:border-box}
    body{margin:0;background:radial-gradient(1200px 800px at 25% -10%,#1e2a56 0%,#0b1020 50%),var(--bg);color:var(--ink);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";}
    .wrap{max-width:960px;margin:24px auto;padding:16px;position:relative}
    header{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:16px}
    .brand{display:flex;align-items:center;gap:10px}
    .brand .logo{width:42px;height:42px;border-radius:50%;background:linear-gradient(135deg,#6fa3ff, #9f78ff);display:grid;place-items:center;font-weight:800;color:white;box-shadow:var(--shadow)}
    .card{background:var(--card);border-radius:var(--br);box-shadow:var(--shadow);padding:20px}
    .center{display:grid;place-items:center;min-height:60vh}
    .stack{display:flex;flex-direction:column;gap:var(--gap)}
    input[type="text"]{width:100%;padding:14px 16px;border-radius:12px;border:1px solid #233066;background:#0f1731;color:var(--ink);outline:none}
    button{border:0;padding:12px 16px;border-radius:12px;background:linear-gradient(135deg,#6fa3ff,#9f78ff);color:white;font-weight:700;cursor:pointer}
    button.ghost{background:transparent;border:1px solid #2e3a70}
    .muted{color:var(--muted);font-size:.95rem}
    .row{display:flex;gap:10px;align-items:center}
    .row.wrap{flex-wrap:wrap}
    .grow{flex:1}
    .score{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .badge{padding:6px 10px;border-radius:999px;background:#0f1731;border:1px solid #273571}
    .progress{width:100%;height:10px;background:#0f1731;border-radius:999px;overflow:hidden;border:1px solid #26336b}
    .progress>div{height:100%;background:linear-gradient(90deg,#ffb84d,#ff6b6b);width:100%}
    .verse{font-size:1.25rem;line-height:1.9}
    .verse .blank{display:inline-block;min-width:8ch;padding:.15rem .35rem;border-bottom:2px dashed #5a73d6;border-radius:6px;background:rgba(122,162,255,.06)}
    .result{padding:12px 14px;border-radius:12px;background:#0f1731;border:1px solid #243267}
    .result.good{border-color:#24674d;background:#0f1d19}
    .result.bad{border-color:#673024;background:#1d1010}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid #243267;text-align:left}
    #adminBtn{position:fixed;bottom:10px;right:10px;background:none;border:none;font-size:24px;cursor:pointer;z-index:5;}
    .card, button{position:relative;z-index:1;}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo">BS</div>
        <div>
          <div style="font-weight:800">창세기 성경 퀴즈</div>
          <div class="muted">빈칸 채우기 · 20초 타이머 · 정답 +30점</div>
        </div>
      </div>
      <div class="row score" id="scoreBoard" style="display:none">
        <div class="badge"><span id="playerBadge">게스트</span></div>
        <div class="badge">점수: <b id="score">0</b> / 1000</div>
        <div class="badge warn">남은시간: <b id="time">20</b>s</div>
        <div class="badge">문항: <b id="qIndex">0</b></div>
        <div class="badge">기회: <b id="lives">10</b></div>
      </div>
    </header>

    <!-- 시작 화면 -->
    <section id="start" class="card center">
      <div class="stack" style="max-width:520px">
        <h1>시작하기</h1>
        <input id="nameInput" type="text" placeholder="이름 (예: 홍길동)" />
        <div class="row">
          <button id="startBtn" type="button" class="grow">시작하기</button>
          <button id="rankBtn" type="button" class="ghost">랭킹 보기</button>
          <button id="howBtn" type="button" class="ghost">규칙 보기</button>
        </div>
      </div>
    </section>

    <!-- 퀴즈 화면 -->
    <section id="quiz" class="card" style="display:none">
      <div class="stack">
        <div class="progress"><div id="bar"></div></div>
        <div class="muted" id="ref"></div>
        <div class="verse" id="verse"></div>
        <div class="row wrap">
          <input id="answer" class="grow" type="text" placeholder="빈칸에 들어갈 단어" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" inputmode="text" />
          <button id="submitBtn" type="button">제출</button>
          <button id="passBtn" type="button" class="ghost">패스</button>
        </div>
        <div id="feedback" class="result" style="display:none"></div>
      </div>
    </section>

    <!-- 랭킹 화면 -->
    <section id="leaderboard" class="card" style="display:none">
      <div class="stack">
        <h2>랭킹</h2>
        <div class="row">
          <button id="backStart" type="button" class="ghost">시작 화면</button>
        </div>
        <table>
          <thead>
            <tr><th>순위</th><th>이름</th><th>점수</th><th>완료 시간</th></tr>
          </thead>
          <tbody id="lbBody"></tbody>
        </table>
      </div>
    </section>

    <!-- 운영자 모드 버튼 -->
    <button id="adminBtn" type="button">🐧</button>
  </div>

  <script>
      let QUESTIONS = [
    {book:"창세기",ref:"1:1",before:"태초에",blank:"하나님",after:"이 천지를 창조하시니라",answers:["하나님"]},
    {book:"창세기",ref:"1:3",before:"하나님이 이르시되",blank:"빛",after:" 있으라 하시매",answers:["빛"]},
    {book:"창세기",ref:"2:7",before:"여호와 하나님이 흙으로 사람을 지으시고 그 코에",blank:"생기",after:"를 불어넣으시니",answers:["생기"]},
    {book:"창세기",ref:"2:18",before:"사람이 혼자 사는 것이",blank:"좋지 아니하니",after:"",answers:["좋지 아니하니"]},
    {book:"창세기",ref:"2:24",before:"둘이",blank:"한 몸",after:"을 이루리라",answers:["한 몸","한몸"]},
    {book:"창세기",ref:"3:1",before:"",blank:"뱀",after:"은 가장 간교하니라",answers:["뱀"]},
    {book:"창세기",ref:"3:6",before:"여자가 그",blank:"열매",after:"를 따먹고",answers:["열매"]},
    {book:"창세기",ref:"3:19",before:"너는 흙이니",blank:"흙으로 돌아갈 것이니라",after:"",answers:["흙으로 돌아갈 것이니라","흙으로돌아갈것이니라"]},
    {book:"창세기",ref:"4:4",before:"여호와께서 아벨과 그의",blank:"제물",after:"은 열납하셨으나",answers:["제물"]},
    {book:"창세기",ref:"4:9",before:"여호와께서 가인에게 이르시되 네",blank:"아우",after:" 아벨이 어디 있느냐",answers:["아우","동생"]},
    {book:"창세기",ref:"6:8",before:"그러나",blank:"노아",after:"는 은혜를 입었더라",answers:["노아"]},
    {book:"창세기",ref:"7:1",before:"너와 네 온 집은",blank:"방주",after:"로 들어가라",answers:["방주"]},
    {book:"창세기",ref:"7:17",before:"",blank:"홍수",after:"가 사십 주야 동안",answers:["홍수"]},
    {book:"창세기",ref:"8:4",before:"방주는",blank:"아라랏산",after:"에 머물렀으며",answers:["아라랏산"]},
    {book:"창세기",ref:"9:13",before:"내",blank:"무지개",after:"를 구름 속에 두었나니",answers:["무지개"]},
    {book:"창세기",ref:"12:1",before:"여호와께서",blank:"아브람",after:"에게 이르시되",answers:["아브람"]},
    {book:"창세기",ref:"12:2",before:"너로 큰",blank:"민족",after:"을 이루고",answers:["민족"]},
    {book:"창세기",ref:"15:6",before:"아브람이 여호와를",blank:"믿으니",after:" 그를 의로 여기셨다",answers:["믿으니","믿었다"]},
    {book:"창세기",ref:"17:5",before:"네 이름을 아브람이 아니라",blank:"아브라함",after:"이라 하리니",answers:["아브라함"]},
    {book:"창세기",ref:"21:3",before:"아브라함이 사라에게서 낳은 아들의 이름을",blank:"이삭",after:"이라 하였고",answers:["이삭"]},
    {book:"창세기",ref:"22:2",before:"네 아들 네 사랑하는 독자",blank:"이삭",after:"을 번제로 드리라",answers:["이삭"]},
    {book:"창세기",ref:"22:14",before:"아브라함이 그곳 이름을",blank:"여호와 이레",after:"라 하였더라",answers:["여호와 이레","여호와이레"]},
    {book:"창세기",ref:"24:15",before:"리브가가 물동이를 어깨에 메고",blank:"나오더라",after:"",answers:["나오더라"]},
    {book:"창세기",ref:"25:23",before:"큰 자는",blank:"작은 자를 섬기리라",after:"",answers:["작은 자를 섬기리라","작은자"]},
    {book:"창세기",ref:"26:12",before:"이삭이 그 땅에서 농사하여",blank:"백배",after:"나 얻었고",answers:["백배","백배나"]},
    {book:"창세기",ref:"27:29",before:"만민이 너를",blank:"섬기고",after:" 열국이 네게 굴복하리니",answers:["섬기고"]},
    {book:"창세기",ref:"28:12",before:"꿈에 본즉 사닥다리가",blank:"하늘에 닿았고",after:"",answers:["하늘에 닿았고","사닥다리"]},
    {book:"창세기",ref:"28:17",before:"이것은",blank:"하나님의 집",after:"이요 이는 하늘의 문이로다",answers:["하나님의 집","하나님집"]},
    {book:"창세기",ref:"29:20",before:"야곱이 라헬을 사랑하므로 칠 년을",blank:"수일같이",after:"여겼더라",answers:["수일같이","며칠같이"]},
    {book:"창세기",ref:"30:22",before:"하나님이 라헬을",blank:"생각하신지라",after:"",answers:["생각하신지라"]},
    {book:"창세기",ref:"32:28",before:"네 이름을 야곱이 아니요",blank:"이스라엘",after:"이라 하리라",answers:["이스라엘"]},
    {book:"창세기",ref:"33:4",before:"에서가 달려와서 야곱을",blank:"안고 입맞추며 울었더라",after:"",answers:["안고 입맞추며 울었더라","안고 울었더라"]},
    {book:"창세기",ref:"35:19",before:"라헬이 죽으매 그를",blank:"베들레헴 길",after:"에 장사하였더라",answers:["베들레헴 길","베들레헴"]},
    {book:"창세기",ref:"37:3",before:"이스라엘이",blank:"요셉",after:"을 더 사랑하므로",answers:["요셉"]},
    {book:"창세기",ref:"37:28",before:"형들이 요셉을 은",blank:"스무 개",after:"에 팔았다",answers:["스무 개","스무개"]},
    {book:"창세기",ref:"39:2",before:"여호와께서 요셉과 함께 하시므로 그가",blank:"형통한 자",after:"가 되었다",answers:["형통한 자","형통"]},
    {book:"창세기",ref:"41:16",before:"요셉이 바로에게 대답하되",blank:"하나님이 평안한 대답을",after:"하시리이다",answers:["하나님이 평안한 대답을","하나님"]},
    {book:"창세기",ref:"41:52",before:"차자의 이름을",blank:"에브라임",after:"이라 하였으니",answers:["에브라임"]},
    {book:"창세기",ref:"45:5",before:"하나님이 생명을",blank:"구원하시려고",after:" 나를 먼저 보내셨나이다",answers:["구원하시려고","구원"]},
    {book:"창세기",ref:"50:20",before:"너희는 나를 해하려 하였으나 하나님은 그것을",blank:"선으로 바꾸사",after:"",answers:["선으로 바꾸사","선"]},
    {book:"창세기",ref:"1:31",before:"하나님이 지으신 모든 것을 보시니",blank:"심히 좋았더라",after:"",answers:["심히 좋았더라","심히좋았더라"]},
    {book:"창세기",ref:"3:15",before:"여자의 후손은 네 머리를",blank:"상하게 할 것이요",after:"",answers:["상하게 할 것이요","상하게"]},
    {book:"창세기",ref:"4:26",before:"셋은 아들을 낳고 그의 이름을",blank:"에노스",after:"라 하였으며",answers:["에노스"]},
    {book:"창세기",ref:"5:24",before:"에녹이 하나님과 동행하더니",blank:"하나님이 데려가시므로",after:"",answers:["하나님이 데려가시므로","데려가시므로"]},
    {book:"창세기",ref:"6:5",before:"사람의",blank:"죄악",after:"이 가득함을 보시고",answers:["죄악"]},
    {book:"창세기",ref:"6:22",before:"노아가 하나님이 명하신 대로",blank:"다 준행하였더라",after:"",answers:["다 준행하였더라","준행하였더라"]},
    {book:"창세기",ref:"8:11",before:"비둘기가 감람나무 새",blank:"잎사귀",after:"를 물고 왔더라",answers:["잎사귀","잎새"]},
    {book:"창세기",ref:"9:6",before:"사람의",blank:"피를 흘리면",after:" 사람이 그 피를 흘리리니",answers:["피를 흘리면","피"]},
    {book:"창세기",ref:"11:9",before:"그 성 이름을",blank:"바벨",after:"이라 하였더라",answers:["바벨"]},
    {book:"창세기",ref:"13:8",before:"아브람이 롯에게 이르되 우리는",blank:"한 친족",after:"이라 다투지 말자",answers:["한 친족","친족"]},
    {book:"창세기",ref:"15:1",before:"나는 네",blank:"방패요",after:" 너의 큰 상급이니라",answers:["방패요","방패"]},
    {book:"창세기",ref:"17:19",before:"네 아내 사라가",blank:"아들을 낳으리니",after:"",answers:["아들을 낳으리니","아들을낳으리니"]},
    {book:"창세기",ref:"18:14",before:"여호와께 능하지 못한 일이 있겠느냐",blank:"사라에게 아들이 있으리라",after:"",answers:["사라에게 아들이 있으리라","사라에게 아들이"]},
    {book:"창세기",ref:"19:26",before:"롯의 아내는 뒤를 돌아보았으므로",blank:"소금 기둥",after:"이 되었더라",answers:["소금 기둥","소금기둥"]},
    {book:"창세기",ref:"21:6",before:"사라가 이르되 하나님이 나를",blank:"웃게 하셨다",after:"",answers:["웃게 하셨다","웃게"]},
    {book:"창세기",ref:"25:34",before:"에서가 장자의",blank:"명분을 경홀히",after:"여겼더라",answers:["명분을 경홀히","장자명분"]},
    {book:"창세기",ref:"28:15",before:"내가 너와 함께 있어",blank:"너를 떠나지 아니하리라",after:"",answers:["너를 떠나지 아니하리라","떠나지 아니하리라"]},
    {book:"창세기",ref:"33:20",before:"야곱이 그곳에 제단을 쌓고 그 이름을",blank:"엘엘로헤이스라엘",after:"이라 불렀더라",answers:["엘엘로헤이스라엘","엘 엘로헤 이스라엘"]},
    {book:"창세기",ref:"35:3",before:"우리를 환난에서 응답하신 하나님께",blank:"예배하자",after:"",answers:["예배하자","제단을 쌓자"]},
    {book:"창세기",ref:"47:9",before:"내 나그네 길의 세월이",blank:"백삼십 년",after:"이니이다",answers:["백삼십 년","백삼십년"]},
    {book:"창세기",ref:"2:2",before:"하나님이 그가 하시던 일을",blank:"일곱째 날에 마치시니",after:"",answers:["일곱째 날에 마치시니","일곱째날에 마치시니"]},
    {book:"창세기",ref:"9:1",before:"하나님이 노아와 그 아들들에게 이르시되",blank:"생육하고 번성하여",after:" 땅에 충만하라",answers:["생육하고 번성하여","생육하고 번성하라"]},
    {book:"창세기",ref:"11:7",before:"자, 우리가 내려가서 그들의",blank:"언어를 혼잡하게 하자",after:"",answers:["언어를 혼잡하게 하자","언어혼잡"]},
    {book:"창세기",ref:"12:3",before:"땅의 모든 족속이 너로 말미암아",blank:"복을 얻을 것이라",after:"",answers:["복을 얻을 것이라","복"]},
    {book:"창세기",ref:"13:14",before:"동서남북을 바라보라 이 땅을 네",blank:"자손에게 주리니",after:"",answers:["자손에게 주리니","자손에게"]},
    {book:"창세기",ref:"14:20",before:"너의 대적을 네 손에 붙이신",blank:"지극히 높으신 하나님",after:"을 찬송할지로다",answers:["지극히 높으신 하나님","지극히높으신하나님"]},
    {book:"창세기",ref:"18:2",before:"아브라함이 눈을 들어 본즉",blank:"세 사람이 서 있는지라",after:"",answers:["세 사람이 서 있는지라","세사람"]},
    {book:"창세기",ref:"18:18",before:"아브라함은 강대한",blank:"나라가 되고",after:"",answers:["나라가 되고","나라"]},
    {book:"창세기",ref:"19:17",before:"생명을 보전하라 뒤를 돌아보지 말고",blank:"산으로 도망하라",after:"",answers:["산으로 도망하라","산으로"]},
    {book:"창세기",ref:"21:10",before:"이 여종과 그 아들을",blank:"내쫓으라",after:"",answers:["내쫓으라","내어쫓으라"]},
    {book:"창세기",ref:"21:12",before:"네 씨는",blank:"이삭으로 말미암으리라",after:"",answers:["이삭으로 말미암으리라","이삭"]},
    {book:"창세기",ref:"22:18",before:"네 씨로 말미암아 천하 만민이",blank:"복을 받으리라",after:"",answers:["복을 받으리라","복"]},
    {book:"창세기",ref:"24:12",before:"아브라함의 하나님 여호와여 오늘 나로",blank:"순조롭게 만나게 하옵소서",after:"",answers:["순조롭게 만나게 하옵소서","순조롭게"]},
    {book:"창세기",ref:"24:27",before:"여호와께서 나를",blank:"인도하사",after:" 내 주인의 동생 집에 이르게 하셨다",answers:["인도하사","인도"]},
    {book:"창세기",ref:"24:60",before:"우리 누이여 너는 천만인의",blank:"어머니가 될지어다",after:"",answers:["어머니가 될지어다","어머니"]},
    {book:"창세기",ref:"26:3",before:"내가 너와 함께 있어 네게",blank:"복을 주리라",after:"",answers:["복을 주리라","복"]},
    {book:"창세기",ref:"26:24",before:"두려워하지 말라 내가 너와 함께 있어 네게",blank:"복을 주며",after:"",answers:["복을 주며","복"]},
    {book:"창세기",ref:"29:28",before:"라반이 딸",blank:"라헬",after:"도 야곱에게 아내로 주었더라",answers:["라헬"]},
    {book:"창세기",ref:"30:27",before:"여호와께서 네게",blank:"복을 주신 줄을",after:" 내가 깨달았다",answers:["복을 주신 줄을","복"]},
    {book:"창세기",ref:"31:49",before:"그 이름을",blank:"미스바",after:"라 하였더라",answers:["미스바"]}
  ];


    const TARGET=1000, POINT=30, LIMIT=20, MAX_LIVES=10;
    let playerName='게스트',score=0,idx=0,left=LIMIT,order=[],timer=null,currentQ=null,lives=MAX_LIVES,locked=false;

    const el={
      start:document.getElementById('start'),quiz:document.getElementById('quiz'),leaderboard:document.getElementById('leaderboard'),
      nameInput:document.getElementById('nameInput'),playerBadge:document.getElementById('playerBadge'),score:document.getElementById('score'),
      time:document.getElementById('time'),qIndex:document.getElementById('qIndex'),bar:document.getElementById('bar'),
      verse:document.getElementById('verse'),ref:document.getElementById('ref'),answer:document.getElementById('answer'),
      feedback:document.getElementById('feedback'),lbBody:document.getElementById('lbBody'),lives:document.getElementById('lives'),
      scoreBoard:document.getElementById('scoreBoard')
    };

    function shuffle(array){
      for(let i=array.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [array[i],array[j]]=[array[j],array[i]];
      }
    }

    function showStart(){
      clearInterval(timer);
      el.start.style.display='grid';
      el.quiz.style.display='none';
      el.leaderboard.style.display='none';
      el.scoreBoard.style.display='none';
      el.lives.textContent = MAX_LIVES;
    }
    function showQuiz(){
      el.start.style.display='none';
      el.quiz.style.display='block';
      el.leaderboard.style.display='none';
      el.scoreBoard.style.display='flex';
    }
    function showLeaderboard(){
      clearInterval(timer);
      el.start.style.display='none';
      el.quiz.style.display='none';
      el.leaderboard.style.display='block';
      el.scoreBoard.style.display='none';
      renderLeaderboard();
    }

    function startGame(){
      playerName=el.nameInput.value||'게스트';el.playerBadge.textContent=playerName;
      score=0;idx=0;lives=MAX_LIVES;el.lives.textContent=lives;
      order=[...Array(QUESTIONS.length).keys()];
      shuffle(order);
      showQuiz();nextQuestion();
    }
    function nextQuestion(){
      if(lives<=0){endGame(false);return;}
      if(order.length===0){order=[...Array(QUESTIONS.length).keys()];shuffle(order);}
      currentQ=QUESTIONS[order.shift()];idx++;
      el.qIndex.textContent=idx;el.ref.textContent=`${currentQ.book} ${currentQ.ref}`;
      el.verse.innerHTML = `${currentQ.before} <span class="blank">_____</span> ${currentQ.after}`;
      resetAnswerInput();
      locked = false;
      setTimeout(function(){ try{ el.answer.focus(); }catch(e){} }, 0);
      runTimer();
    }
    function runTimer(){left=LIMIT;el.time.textContent=left;el.bar.style.width='100%';clearInterval(timer);timer=setInterval(()=>{left--;el.time.textContent=left;el.bar.style.width=(left/LIMIT*100)+'%';if(left<0){clearInterval(timer);loseLife(`⏰ 시간초과! 정답: ${currentQ.blank}`);}},1000);}
    function submitAnswer(){
      if(locked) return; locked=true;
      const ans=norm(el.answer.value.trim());
      const accepts=(currentQ.answers&&currentQ.answers.length? currentQ.answers : [currentQ.blank]).map(norm);
      if(accepts.includes(ans)){ 
        score+=POINT;el.score.textContent=score;feedback(true,'정답!');
      } else {
        loseLife('오답! 정답:'+currentQ.blank);
        return;
      }
      setTimeout(nextQuestion,800);
    }
    function loseLife(msg){
      locked=true;
      lives--;el.lives.textContent=lives;feedback(false,msg);
      if(lives<=0){endGame(false);} else {setTimeout(nextQuestion,800);}
    }
    function feedback(ok,msg){el.feedback.style.display='block';el.feedback.textContent=msg;el.feedback.className='result '+(ok?'good':'bad');}

    function endGame(success=true){
      if(success){
        const now=new Date();
        const finished= now.getFullYear()+"-"+String(now.getMonth()+1).padStart(2,'0')+"-"+String(now.getDate()).padStart(2,'0')+" "+now.toLocaleTimeString();
        let records=JSON.parse(localStorage.getItem('records')||'[]');
        records.push({name:playerName,score:score,time:finished});
        localStorage.setItem('records',JSON.stringify(records));
      }
      showLeaderboard();
    }

    function renderLeaderboard(){
      let records=JSON.parse(localStorage.getItem('records')||'[]');
      records.sort((a,b)=> b.score-a.score);
      el.lbBody.innerHTML=records.map((r,i)=>`<tr><td>${i+1}</td><td>${r.name}</td><td>${r.score}</td><td>${r.time}</td></tr>`).join('');
    }

    document.getElementById('startBtn').onclick=startGame;
    document.getElementById('submitBtn').onclick=submitAnswer;
    function norm(s){
      s = (s||'').toString().toLowerCase();
      s = s.split(' ').join('');
      var rm = ['[',']','(',')','{','}','\'','.',',',':',';','!','?','·','…','—','–','-','"'];
      for (var i=0;i<rm.length;i++){ s = s.split(rm[i]).join(''); }
      return s;
    }
    function isCorrectInput(){
      if(!currentQ) return false;
      var ans = norm(document.getElementById('answer').value);
      var accepts = (currentQ.answers && currentQ.answers.length ? currentQ.answers : [currentQ.blank]).map(norm);
      return accepts.includes(ans);
    }
    function attachAnswerListeners(){
      el.answer.addEventListener('keydown', function(e){ if(e.key==='Enter'){ submitAnswer(); }});
      el.answer.addEventListener('input', function(){ if(!locked && isCorrectInput()){ submitAnswer(); }});
    }
    function resetAnswerInput(){
      var old = document.getElementById('answer');
      var fresh = old.cloneNode(false);
      fresh.id = 'answer';
      fresh.className = old.className;
      fresh.type = old.type || 'text';
      fresh.placeholder = old.placeholder || '';
      fresh.autocomplete = 'off';
      fresh.autocapitalize = 'off';
      fresh.autocorrect = 'off';
      fresh.spellcheck = false;
      fresh.inputMode = 'text';
      old.parentNode.replaceChild(fresh, old);
      el.answer = fresh;
      el.answer.value = '';
      attachAnswerListeners();
    }
    attachAnswerListeners();
    document.getElementById('passBtn').onclick=()=>{loseLife('패스! 정답:'+currentQ.blank)};
    document.getElementById('rankBtn').onclick=showLeaderboard;
    document.getElementById('backStart').onclick=showStart;

    // 운영자 모드 버튼
    document.getElementById('adminBtn').onclick=()=>{
      const pw=prompt('비밀번호 입력');
      if(pw==='eckc3004'){
        if(confirm('랭킹을 초기화하시겠습니까?')){
          localStorage.removeItem('records');
          alert('랭킹이 초기화되었습니다.');
          renderLeaderboard();
        }
      } else {alert('비밀번호 오류');}
    };

    showStart();
  </script>
</body>
</html>
